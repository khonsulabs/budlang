<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A safe, fast, lightweight embeddable scripting language written in Rust."><title>budlang - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-c4dbdcde0fbd8430.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../static.files/light-db279b6232be9c13.css"><link rel="stylesheet" disabled href="../static.files/dark-cf923f49f397b216.css"><link rel="stylesheet" disabled href="../static.files/ayu-be46fdc453a55015.css"><script src="../static.files/storage-3891ce972e3a2bf8.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-98a684e84ae5b08b.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../budlang/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../budlang/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Crate budlang</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.0.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#reexports">Re-exports</a></li><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">budlang</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/budlang/lib.rs.html#1-497">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A safe, fast, lightweight embeddable scripting language written in Rust.</p>
<h3 id="why-bud"><a href="#why-bud">Why Bud?</a></h3><h4 id="memory-safe"><a href="#memory-safe">Memory-safe</a></h4>
<p>This project forbids unsafe code (<code>#![forbid(unsafe_code)]</code>), and has only one
dependency: <a href="https://github.com/khonsulabs/budlang/blob/main/budvm"><code>budvm</code></a>. The only unsafe code depended on by this crate is
in Rust’s standard library.</p>
<h4 id="safe-to-run-untrusted-code"><a href="#safe-to-run-untrusted-code">Safe to run untrusted code</a></h4>
<p>The virtual machine invokes <a href="crate::vm::Environment::step"><code>Environment::step()</code></a> before each
instruction is exected. The environment can return
<a href="crate::vm::ExecutionBehavior::Pause"><code>ExecutionBehavior::Pause</code></a> to pause execution, and the state of the
virtual machine will be saved such that it can be resumed again.</p>
<p><strong>Work In Progress:</strong> Bud will have various configuration
options including maximum stack size, maximum memory used, and more.</p>
<p><strong>Work In Progress:</strong> Bud should never panic. This crate is in early
development, so many instances of <code>todo!()</code> and <code>unwrap()</code> abound. These will
all be replaced with descriptive errors instead of panics.</p>
<p>Bud will only support these primitive types: integers, real numbers (floating
point), strings, lists, and maps. Bud will be able to be extended to support
additional features via Rust, placing the developer embedding Bud in full
control of what scripts can do.</p>
<h4 id="efficient"><a href="#efficient">Efficient</a></h4>
<p>Bud is a compiled language powered by its own virtual machine. Currently, Bud
has no optimizer, but the virtual machine code generated by the compiler closely
mirrors the syntax of the language. For example, the repository includes three
examples of a naive <a href="https://en.wikipedia.org/wiki/Fibonacci_number">Fibonacci number</a> function implementation. The <a href="https://github.com/khonsulabs/budlang/blob/main/budlang/examples/fib.rs">Bud
version</a> looks like this:</p>
<div class="example-wrap"><pre class="language-bud"><code>function fibonacci(n)
    if n &lt;= 2
        1
    else
        this(n - 1) + this(n - 2)
    end
end
</code></pre></div>
<p>Another example <a href="https://github.com/khonsulabs/budlang/blob/main/budvm/examples/fib-vm.rs">shows an identical implementation</a> using hand-written
virtual machine instructions. Despite not having an optimizer, the compiled
<code>fibonacci()</code> function’s code is nearly identical, having one extra (unreachable)
instruction:</p>
<div><table><thead><tr><th>#</th><th>hand-written</th><th>#</th><th>compiled</th></tr></thead><tbody>
<tr><td>0</td><td><code>lte @0 2 jump 2</code></td><td>0</td><td><code>lte @0 2 jump 3</code></td></tr>
<tr><td>1</td><td><code>return 1</code></td><td>1</td><td><code>return 1</code></td></tr>
<tr><td></td><td></td><td>2</td><td><code>jump 8</code></td></tr>
<tr><td>2</td><td><code>sub @0 1 stack</code></td><td>3</td><td><code>sub @0 1 stack</code></td></tr>
<tr><td>3</td><td><code>recurse 1 $0</code></td><td>4</td><td><code>recurse 1 $0</code></td></tr>
<tr><td>4</td><td><code>sub @0 2 stack</code></td><td>5</td><td><code>sub @0 2 stack</code></td></tr>
<tr><td>5</td><td><code>recurse 1 $1</code></td><td>6</td><td><code>recurse 1 $1</code></td></tr>
<tr><td>6</td><td><code>add $0 $1 $$</code></td><td>7</td><td><code>add $0 $1 $$</code></td></tr>
</tbody></table>
</div><h3 id="why-not-bud"><a href="#why-not-bud">Why not Bud?</a></h3>
<p>It probably doesn’t do what you need (yet):</p>
<ul>
<li><input disabled="" type="checkbox" checked=""/>
Don’t panic in vm</li>
<li><input disabled="" type="checkbox"/>
Don’t panic in compiler</li>
<li><input disabled="" type="checkbox"/>
Don’t panic in parser</li>
<li><input disabled="" type="checkbox" checked=""/>
Support parenthesized expressions as terms</li>
<li><input disabled="" type="checkbox" checked=""/>
Add variables</li>
<li><input disabled="" type="checkbox"/>
Add loops</li>
<li><input disabled="" type="checkbox" checked=""/>
Add Real (Float) type</li>
<li><input disabled="" type="checkbox" checked=""/>
Add String type</li>
<li><input disabled="" type="checkbox" checked=""/>
Add List type</li>
<li><input disabled="" type="checkbox" checked=""/>
Add Map type</li>
<li><input disabled="" type="checkbox" checked=""/>
Ability to write Rust functions</li>
<li><input disabled="" type="checkbox" checked=""/>
Implement a REPL</li>
<li><input disabled="" type="checkbox"/>
Consider static variables for persistent module state.</li>
</ul>
<p>Bud is compiled to a virtual machine written using only memory-safe abstractions
in Rust. This yields quite good performance for a dynamically typed language,
but will not be the fastest language.</p>
<h3 id="goals-for-bud"><a href="#goals-for-bud">Goals for Bud</a></h3>
<p>Aside from the goals outlined above, the use cases it’s being designed for are:</p>
<ul>
<li>A <a href="https://bonsaidb.io/">BonsaiDb</a> REPL</li>
<li>Multi-player server-side scripting where user-submitted scripts are allowed.</li>
</ul>
</div></details><h2 id="reexports" class="small-section-header"><a href="#reexports">Re-exports</a></h2><ul class="item-table"><li><div class="item-name" id="reexport.vm"><code>pub use budvm as vm;</code></div></li></ul><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="ast/index.html" title="mod budlang::ast">ast</a></div><div class="desc docblock-short">The abstract syntax tree Bud uses.</div></li><li><div class="item-name"><a class="mod" href="parser/index.html" title="mod budlang::parser">parser</a></div><div class="desc docblock-short">The interface for parsing Bud code.</div></li></ul><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Bud.html" title="struct budlang::Bud">Bud</a></div><div class="desc docblock-short">A Bud virtual machine instance.</div></li><li><div class="item-name"><a class="struct" href="struct.BudEnvironment.html" title="struct budlang::BudEnvironment">BudEnvironment</a></div><div class="desc docblock-short">A wrapper for a <a href="trait.Environment.html" title="trait budlang::Environment"><code>Environment</code></a> that implements [<code>budvm::Environment</code>].</div></li></ul><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.Error.html" title="enum budlang::Error">Error</a></div><div class="desc docblock-short">All errors that can be encountered executing Bud code.</div></li><li><div class="item-name"><a class="enum" href="enum.Intrinsic.html" title="enum budlang::Intrinsic">Intrinsic</a></div><div class="desc docblock-short">A runtime intrinsic function.</div></li></ul><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.Environment.html" title="trait budlang::Environment">Environment</a></div><div class="desc docblock-short">Customizes the behavior of a virtual machine instance.</div></li></ul></section></div></main><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="budlang" data-themes="" data-resource-suffix="" data-rustdoc-version="1.69.0 (84c898d65 2023-04-16)" data-search-js="search-8a59a8356673ec1f.js" data-settings-js="settings-f0c5c39777a9a2f6.js" data-settings-css="settings-0bcba95ff279c1db.css" ></div></body></html>